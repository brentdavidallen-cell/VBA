<!--ArborText, Inc., 1988-2002, v.4002-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Events in MicroStation</title>
<link href="/Office.css" type="text/css" rel="StyleSheet" media="screen"></head>
<body><div><h1>Events in MicroStation</h1><p>The VBA environment in MicroStation
CONNECT Edition does not have the capability of creating new event types. There are some
specific events in MicroStation that your VBA program can listen for and respond
to. The Application and UndoBuffer objects both fire events of interest to
VBA programs.</p><div><h2>Receiving events</h2><p>The first challenge in handling
events is telling MicroStation that your class wants to receive the event
messages. This is done by creating a reference to the type of object that
is generating the events using the WithEvents keyword. To listen for events
from the Application object, the reference is created like this:</p><p><code>
Dim WithEvents oApplication As Application</code></p><p>Remember, this isn't
creating an Application object, it's just creating a reference to an Application
object. When the class is actually ready to receive the event messages, this
reference is set to the object itself. In the case of the Application object,
the code would be:</p><p><code>Set oApplication = Application</code></p><p>
From this point on, the class receives the events coming from the Application
object. It is up to you to decide which events to handle.</p><p><b>Note:</b> The
WithEvents keyword is only valid in a class module. The sub procedures you
create to respond to the events are part of the class, and are called &ldquo;event
handlers&rdquo;.</p></div><div><h2>Application events</h2><p>The Application
object in MicroStation only has two events that your VBA program can receive.
These are the <a href="ms-its:MicroStationVBA.chm::/html/usevtondesignfileopened.htm">
OnDesignFileOpened</a> and <a href="ms-its:MicroStationVBA.chm::/html/usevtondesignfileclosed.htm">
OnDesignFileClosed</a> events. These are discussed in detail in the section
titled <a href="usvba_working_with_events.htm">Working with MicroStation events
</a>, so they are not discussed further here.</p></div></div></body>
</html>
