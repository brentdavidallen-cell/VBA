<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Adding and Deleting a Model's XData</TITLE>
<style>@import url(/Office.css);</style>
<link disabled rel="stylesheet" href="/MSOffice.css"></HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H1 class=RH1>Adding and Deleting a Model's XData</H1>

<PRE class=CT><CODE>
Private Const MyAppName As String = "XDataSample"
'
'   Adds XData to the active model
'
Sub DoAdd()
    Dim Xdata() As <A href="usudtXDatum.htm">XDatum</A>
    Dim theID As <A href="usudtDLong.htm">DLong</A>

    <A href="usmthAppendXDatum.htm">AppendXDatum</A> Xdata, msdXDatumTypeControlString, "{"
    AppendXDatum Xdata, msdXDatumTypePoint, <A href="usmthPoint3dFromXYZ.htm">Point3dFromXYZ</A>(10, 10, 50)

    theID = <A href="usproActiveModelReference.htm">ActiveModelReference</A>.<A href="usmthGetLastValidGraphicalElement.htm">GetLastValidGraphicalElement</A>.<A href="usproID.htm">ID</A>
    AppendXDatum Xdata, msdXDatumTypeDatabaseHandle, <A href="usmthDLongToHexString.htm">DLongToHexString</A>(theID)

    AppendXDatum Xdata, msdXDatumTypeDistance, 12345
    AppendXDatum Xdata, msdXDatumTypeInt16, 32767
    AppendXDatum Xdata, msdXDatumTypeInt32, 132767
    AppendXDatum Xdata, msdXDatumTypePoint, Point3dFromXYZ(10, 200, 3000)
    AppendXDatum Xdata, msdXDatumTypeReal, 27.1234
    AppendXDatum Xdata, msdXDatumTypeScaleFactor, 1234.27
    AppendXDatum Xdata, msdXDatumTypeString, "An Xdata String"
    AppendXDatum Xdata, msdXDatumTypeWorldSpacePosition, Point3dFromXYZ(4, 400, -20)
    AppendXDatum Xdata, msdXDatumTypeLevel, "MyLevel"
    AppendXDatum Xdata, msdXDatumTypeControlString, "}"

    ActiveModelReference.<A href="usmthSetXData.htm">SetXData</A> MyAppName, Xdata

End Sub
'
'   Deletes XData from a model
'
Sub DoDelete(theModel As <A href="usobjModelReference.htm">ModelReference</A>, strAppName As String)
    theModel.<A href="usmthDeleteXData.htm">DeleteXData</A> strAppName
End Sub


</CODE></PRE>
