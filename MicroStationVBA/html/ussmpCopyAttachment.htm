<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Copying an Attachment</TITLE>
<style>@import url(/Office.css);</style>
<link disabled rel="stylesheet" href="/MSOffice.css"></HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H1 class=RH1>Copying an Attachment</H1>

<P class=T>

</P>
<PRE class=CT><CODE>
'  Creates a new attachment with the same parameters as an existing attachment.
Sub CopyAndReplace(att As <A href="usobjAttachment.htm">Attachment</A>, strFileName As String, strNewModel As String)
    Set att = att.<A href="usmthCopy.htm">Copy</A>

    On Error GoTo BadAttachment
    att.<A href="usmthReattach.htm">Reattach</A> strFileName, strNewModel
    Exit Sub

BadAttachment:
    Dim attParent As <A href="usobjModelReference.htm">ModelReference</A>

    Set attParent = att.<A href="usproParentModelReference.htm">ParentModelReference</A>
    attParent.<A href="usproAttachments.htm">Attachments</A>.<A href="usmthRemove.htm">Remove</A> att
    <A href="usmthRedrawAllViews.htm">RedrawAllViews</A>
End Sub

</CODE></PRE>
