<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Changing an Attachment to Reference the Default Model</TITLE>
<style>@import url(/Office.css);</style>
<link disabled rel="stylesheet" href="/MSOffice.css"></HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H1 class=RH1>Changing an Attachment to Reference the Default Model</H1>

<P class=T>

</P>
<PRE class=CT><CODE>
Sub AttachDefaultModel(att As <A href="usobjAttachment.htm">Attachment</A>)
    Dim mdl As <A href="usobjModelReference.htm">ModelReference</A>

    Set mdl = att.<A href="usproDesignFile.htm">DesignFile</A>.<A href="usproDefaultModelReference.htm">DefaultModelReference</A>
    If mdl.<A href="usproName.htm">Name</A> &lt;&gt; att.Name Then
        ' Reattach creates a new Attachment object. The old one is no longer
        ' usable.
        Set att = att.<A href="usmthReattach.htm">Reattach</A>(vbNullString, mdl.Name)
        att.<A href="usproLogicalDescription.htm">LogicalDescription</A> = "Reattached " & Now
        att.<A href="usmthRewrite.htm">Rewrite</A>
    End If
End Sub

</CODE></PRE>
