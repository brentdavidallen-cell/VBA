<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Determining a Custom Property's Data Type</TITLE>
<style>@import url(/Office.css);</style>
<link disabled rel="stylesheet" href="/MSOffice.css"></HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H1 class=RH1>Determining a Custom Property's Data Type</H1>

<P class=T>
This example shows how to determine the data type of a design file's custom
            property by retrieving the value of the custom property and examining the result
            with the standard Visual Basic function VarType.
</P>
<PRE class=CT><CODE>
' Extract the type and translate it to a name
Function GetResultType(var As Variant) As String
    <A href="usmthSelect.htm">Select</A> Case VarType(var)
        Case vbEmpty
            GetResultType = "vbEmpty"
        Case vbNull
            GetResultType = "vbNull"
        Case vbInteger
            GetResultType = "vbInteger"
        Case vbLong
            GetResultType = "vbLong"
        Case vbSingle
            GetResultType = "vbSingle"
        Case vbDouble
            GetResultType = "vbDouble"
        Case vbCurrency
            GetResultType = "vbCurrency"
        Case vbDate
            GetResultType = "vbDate"
        Case vbString
            GetResultType = "vbString"
        Case vbObject
            GetResultType = "vbObject"
        Case vbError
            GetResultType = "vbError"
        Case vbBoolean
            GetResultType = "vbBoolean"
        Case vbVariant
            GetResultType = "vbVariant"
        Case vbDataObject
            GetResultType = "vbDataObject"
        Case vbDecimal
            GetResultType = "vbDecimal"
        Case vbByte
            GetResultType = "vbByte"
        Case vbUserDefinedType
            GetResultType = "vbUserDefinedType"
        Case vbArray
            GetResultType = "vbArray"
    End Select
End Function

Sub SetVariable()
    Dim result As Variant

    With <A href="usproActiveDesignFile.htm">ActiveDesignFile</A>
        ' This call stores a Boolean value
        .<A href="usmthSetCustomProperty.htm">SetCustomProperty</A> "TEST1", True
        result = .<A href="usmthGetCustomProperty.htm">GetCustomProperty</A>("TEST1")
        Debug.Print "Property type is " & GetResultType(result)

        ' This call stores a String value
        .SetCustomProperty "TEST1", "StringValue"
        result = .GetCustomProperty("TEST1")
        Debug.Print "Property type is " & GetResultType(result)

        ' This call stores a Long value
        .SetCustomProperty "TEST1", 1
        result = .GetCustomProperty("TEST1")
        Debug.Print "Property type is " & GetResultType(result)

        ' This call stores a Double value
        .SetCustomProperty "TEST1", 100.5
        result = .GetCustomProperty("TEST1")
        Debug.Print "Property type is " & GetResultType(result)

        ' This call stores a Date value
        .SetCustomProperty "TEST1", Date
        result = .GetCustomProperty("TEST1")
        Debug.Print "Property type is " & GetResultType(result)
    End With
End Sub

</CODE></PRE>
